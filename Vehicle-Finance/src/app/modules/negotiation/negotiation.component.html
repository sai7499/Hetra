<main>
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-6">
        <!-- <h3>{{ labels?.negotiationTitle }}</h3> -->
      </div>
      <div class="col-md-6 text-right">
        <div class="col-sm-6 col-md-4 col-lg-3">
        </div>
      </div>
    </div>

    <div class="" id="disbursement-memo">
      <form [formGroup]="createNegotiationForm" class="form-horizontal" autocomplete="off" style="padding-bottom: 0;">
        <div class="panel-group" id="accordion" style="margin-bottom: 0;">
          <div class="row">
              <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">
                <h3 class="banner-con">{{ labels?.negotiationTitle }}
                  <span class="float-right">{{udfScreenId}}</span>
                </h3>
              </div>
            </div>
          <div class="panel panel-default">
            <a class="panel-heading panel-primary title collapsed display-block" data-toggle="collapse" data-parent="#accordion" href="#leadDetails">
              <h4 class="panel-title">
                <a> {{ labels?.leadReferenceDetails }} <i class="fa fa-angle-down"></i> </a>
              </h4>
            </a>
            <div id="leadDetails" class="panel-collapse collapse in">
              <div class="panel-body">
                <div class="clearfix">
                  <div class="form-group">
                    <label class="control-label col-sm-5 col-md-4 col-lg-3" for="productCode">{{labels?.productLMSCode}}</label>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                      <input formControlName="productCode" type="text" class="form-control mandatory select2" id="productCode" placeholder="Product (LMS Code - Name)"
                        name="productCode" />
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="control-label col-sm-5 col-md-4 col-lg-3" for="applicant">{{labels?.applicantName}}</label>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                      <input formControlName="applicant" type="text" class="form-control mandatory select2" id="applicant" placeholder="Applicant"
                        name="applicant" />
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="control-label col-sm-5 col-md-4 col-lg-3"></label>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                      <input formControlName="CustomerCategory" type="text" class="form-control mandatory select2" id="CustomerCategory" placeholder="Applicant Category"
                        name="CustomerCategory" />
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="control-label col-sm-5 col-md-4 col-lg-3" for="reqLoanAmount">{{labels?.requestedLoanAmount}}</label>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                      <input formControlName="reqLoanAmount" type="text" class="form-control mandatory select2" id="reqLoanAmount" placeholder="Requested Loan Amount"
                        name="reqLoanAmount" />
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="control-label col-sm-5 col-md-4 col-lg-3" for="reqLoanTenor">{{labels?.requestedLoanTenor}}</label>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                      <input formControlName="reqLoanTenor" type="text" class="form-control mandatory select2" id="reqLoanTenor" placeholder="Requested Loan Tenor"
                        name="reqLoanTenor" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>

    <div class="negotiation-form" id="disbursement-memo">
      <form [formGroup]="createNegotiationForm" class="form-horizontal" autocomplete="off">

        <div class="panel-group" id="accordion">
          <div class="panel panel-default" *ngFor="let ticket of t.controls; let i = index">
            <a class="panel-heading panel-primary title collapsed" data-toggle="collapse" data-parent="#accordion" href="#assetDetails{{i+1}}">
              <h4 *ngIf="t.controls.length >=1" class="panel-title">
                <a> {{ labels?.assetDetails }} - {{i +1}} <i class="fa fa-angle-down"></i> </a>
              </h4>
              <!-- <h4 *ngIf="t.controls.length ==1" class="panel-title">
                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#assetDetails2">
                  {{ labels?.assetDetails }}
                  <i class="fa fa-angle-down"></i>
                </a>
              </h4> -->
            </a>
            <div id="assetDetails{{i+1}}" class="panel-collapse collapse">
              <div class="panel-body">
                <div class="clearfix">
                  <div [formGroup]="ticket">
                    <div class="form-group" *ngIf="this.productCategoryList">
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="vehicleModel">{{ labels?.VehicleModel }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="vehicleModel" type="text" class="form-control mandatory select2" id="vehicleModel" placeholder="Vehicle Model"
                          name="vehicleModel" />
                      </div>
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="fundingProgram">{{ labels?.FundingProgram }} </label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="fundingProgram" type="text" class="form-control mandatory select2" id="fundingProgram" placeholder="Funding Program"
                          name="fundingProgram" />
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="PromotionScheme" *ngIf="AssetDetailsList[i].PromotionScheme">{{ labels?.promotionScheme }}
                      </label>
                      <div class="col-sm-6 col-md-4 col-lg-3 label-space" *ngIf="AssetDetailsList[i].PromotionScheme">
                        <input type="text" class="form-control mandatory select2" formControlName="PromotionScheme" id="PromotionScheme" placeholder="Promotion Scheme"
                          name="promotionScheme" />
                      </div>
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="regNo" *ngIf="showRegFields">{{ labels?.RegNo }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3" *ngIf="showRegFields">
                        <input formControlName="regNo" type="text" class="form-control mandatory select2" id="regNo" placeholder="Reg.No" name="regNo"
                        />
                      </div>
                    </div>
                    <div class="form-group" *ngIf="showRegFields">
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="ManufacturingYear">{{ labels?.ManufacturingYear }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="ManufacturingYear" type="text" class="form-control mandatory select2" id="ManufacturingYear" placeholder="Manufacturing Year"
                          name="ManufacturingYear" />
                      </div>
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="ageofAsset">{{ labels?.AgeofAsset }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="ageofAsset" type="text" class="form-control mandatory select2" id="ageofAsset" placeholder="Age of Asset as on date"
                          name="ageofAsset" />
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="netAssetCost">{{ labels?.NetAssetCost }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="netAssetCost" type="text" class="form-control mandatory select2" id="netAssetCost" placeholder="Net Asset Cost (in INR)"
                          name="netAssetCost" />
                      </div>
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="eligibleLTV">{{ labels?.EligibleLTV }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="eligibleLTV" type="text" class="form-control mandatory select2" id="eligibleLTV" placeholder="Eligible LTV (in %)"
                          name="eligibleLTV" />
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="eligibleLoanAmount">{{ labels?.EligibleLoanAmount }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="eligibleLoanAmount" type="text" class="form-control mandatory select2" id="eligibleLoanAmount" placeholder="Eligible Loan Amount (in INR)"
                          name="eligibleLoanAmount" />
                      </div>
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="eligibleLoanTenor">{{ labels?.EligibleLoanTenor }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="eligibleLoanTenor" type="text" class="form-control mandatory select2" id="eligibleLoanTenor" placeholder="Eligible Loan Tenor"
                          name="eligibleLoanTenor" />
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="EligibleIRR">{{ labels?.EligibleIRR }}</label>
                      <div class="col-sm-6 col-md-4 col-lg-3">
                        <input formControlName="EligibleIRR" type="text" class="form-control mandatory select2" id="EligibleIRR" placeholder="Eligible IRR (%)"
                          name="EligibleIRR" />
                      </div>
                    </div>

                    <div class="panel-group col-xs-12" id="accordion" [formGroup]="ticket">
                      <div class="panel panel-default" formGroupName="negotiationformArray">
                        <a class="panel-heading collapsed" data-toggle="collapse" data-parent="#accordion" href="#negoDetails{{i+1}}">
                          <h4 class="panel-title">
                            <a> Negotiation Details <i class="fa fa-angle-down"></i> </a>
                          </h4>
                          <!-- <h4 class="title">{{ labels?.negotiationTitle }} - {{i +1}}</h4> -->
                        </a>
                        <div id="negoDetails{{i+1}}" class="panel-collapse collapse">
                          <div class="panel-body">
                            <div class="clearfix">
                              <div class="form-group">
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NegotiatedLoanAmount">{{ labels?.NegotiatedLoanAmount }}
                                  <sub class="star_red_col">*</sub>
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="NegotiatedLoanAmount" [isDirty]="isDirty" [className]="'form-control mandatory'" [type]="'number'"
                                    [isRequired]="'Negotiated Loan Amount is Required'" [placeholder]="'Negotiated Loan Amount'"
                                    (change)="allowvaluesforNegoAmount($event,i);calculateEMI(i);calculateTotal(i)" [maxLength]="labels?.validationData.NegotiatedLoanAmount.maxLength"
                                    [minLength]="labels?.validationData.NegotiatedLoanAmount.maxLength">
                                  </app-custom-input>
                                <input *ngIf="!AssetDetailsList[i]" formControlName="variableIRR" class="form-control">
                                </div>
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NegotiatedLoanTenor" *ngIf="!((AssetDetailsList[i].schemeType=='S') || (AssetDetailsList[i].schemeType=='SI'))">
                                  {{ labels?.NegotiatedLoanTenor }}
                                  <sub class="star_red_col">*</sub>
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3" *ngIf="!((AssetDetailsList[i].schemeType=='S') || (AssetDetailsList[i].schemeType=='SI'))">
                                  <app-custom-input formControlName="NegotiatedLoanTenor" [isDirty]="isDirty" [className]="'form-control mandatory'" [type]="'number'"
                                  (change)="validateNegoLoanTenor($event,i);getRepayableMonths(i);calculateEMI(i);loanBookingEmi(i)"
                                    [placeholder]="'Negotiated Loan Tenor (in Months)'" [isRequired]="'Negotiated Loan Tenor is Required'"
                                    [maxLength]="labels?.validationData.NegotiatedLoanTenor.maxLength" [minLength]="labels?.validationData.NegotiatedLoanTenor.maxLength">
                                  </app-custom-input>
                                </div>
                              </div>
                              <div class="form-group" *ngIf="!((AssetDetailsList[i].schemeType=='S') || (AssetDetailsList[i].schemeType=='SI'))">
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NegotiatedIRR">{{ labels?.NegotiatedIRR }}
                                  <sub class="star_red_col">*</sub>
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="NegotiatedIRR" [isDirty]="isDirty" [className]="'form-control mandatory'" [isRequired]="'Negotiated IRR is Required'"
                                    [type]="'decimal'" [maxLength]="labels?.validationData.NegotiatedIRR.maxLength" [placeholder]="'Negotiated IRR (in %)'"
                                  step="0.01" (keypress)="isDecimal($event);" (change)="allowValuesforNegoIRR($event,i);calculateVarianceIRR(i)">
                                  </app-custom-input>
                                </div>
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NegotiatedEMI">{{ labels?.NegotiatedEMI }}
                                  <sub class="star_red_col">*</sub>
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="NegotiatedEMI" [isDirty]="isDirty" [className]="'form-control mandatory'" [isRequired]="'Negotiated EMI is Required'"
                                  [type]="'number'" [placeholder]="'Negotiated EMI (in INR)'" (change)="allowValuesforNegoEMI($event,i,1)">
                                  </app-custom-input>
                                </div>
                              </div>
                              <div class="form-group" *ngIf="(AssetDetailsList[i].schemeType=='S') || (AssetDetailsList[i].schemeType=='SI')">
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="subventSchemeLoanTenor">{{labels?.subSchemeLoanTenor}}
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="subventSchemeLoanTenor" [isDirty]="isDirty" [className]="'form-control mandatory'"
                                    [type]="'decimal'" [placeholder]="'Subvention Scheme Loan Tenor (in Months)'">
                                  </app-custom-input>
                                </div>
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="subventionSchemeIRR">{{labels?.SubSchemeIRR}}
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="subventionSchemeIRR" [isDirty]="isDirty" [className]="'form-control mandatory'"
                                  [type]="'decimal'" [placeholder]="'Subvention Scheme IRR (in %)'" (change)="calculateSubventionVarianceIRR($event)">
                                  </app-custom-input>
                                </div>
                              </div>
                              <div class="form-group" *ngIf="(AssetDetailsList[i].schemeType=='S') || (AssetDetailsList[i].schemeType=='SI')">
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="subventSchemeEMI">{{labels?.SubSchemeEMI}}
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="subventSchemeEMI" [isDirty]="isDirty" [className]="'form-control mandatory'"
                                    [type]="'decimal'" [placeholder]="'Subvention Scheme EMI (in INR)'" step="0.01">
                                  </app-custom-input>
                                </div>
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="subventAmount">{{labels?.SubAmount}}
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="subventAmount" [isDirty]="isDirty" [className]="'form-control mandatory'"
                                    [placeholder]="'Subvention Amount (in INR)'">
                                  </app-custom-input>
                                </div>
                              </div>
                              <div class="form-group" *ngIf="(AssetDetailsList[i].schemeType=='I') || (AssetDetailsList[i].schemeType=='SI')">
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="incentiveAmount">{{labels?.incentiveAmount}}
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="incentiveAmount" [isDirty]="isDirty" [className]="'form-control mandatory'"
                                     [placeholder]="'Incentive Amount (in INR)'">
                                  </app-custom-input>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="panel-group col-xs-12" id="accordion" *ngIf="this.productCategoryList">
                      <div class="panel panel-default" *ngIf="InsuranceProvidersLabel">
                        <!-- <div *ngFor="let ins of createNegotiationForm.controls.CrossSellInsurance['controls'][i].controls"> -->
                        <!-- <div formArrayName="0"> -->
                        <a class="panel-heading collapsed" data-toggle="collapse" data-parent="#accordion" href="#crosssellInsurance{{i+1}}">
                          <h4 class="panel-title">
                            <a> {{ labels?.crossSellInsurance }} <i class="fa fa-angle-down"></i> </a>
                          </h4>
                        </a>
                        <div id="crosssellInsurance{{i+1}}" class="panel-collapse collapse">
                          <div class="panel-body">
                            <div class="clearfix" formGroupName="CrossSellInsurance">
                                <div formGroupName="motor" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="business_division">{{ InsuranceProvidersLabel[0]?.insurance_type_name }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3 position-relative">
                                      <!-- calculatepremiumAmount($event,1,i) -->
                                    <app-vf-custom-select [values]="InsuranceProvidersLOV" formControlName="motorInsurance" [isDirty]="isDirty" [isRequired]="'FRSD / Motor Insurance is required'"
                                      (change)="getUIValues($event, true, 'MI',i);fetchPrmAmount(1,'motor',i,'callFun')">
                                    </app-vf-custom-select>
                                    <!-- <button type="button" [disabled]="motarButtonFlag[i]" (click)="fetchPreimumAmount(1,'motor',i)" class="calc-icon">
                                    </button> -->
                                    <button type="button" [disabled]="motarButtonFlag[i]" (click)="fetchPrmAmount(1,'motor',i,'callFun')" class="calc-icon">
                                      </button>
                                  </div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="MITenure">{{ labels?.MITenure }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                    <app-custom-input formControlName="MITenure" type="number" class="form-control mandatory select2 custom-negotiation-field"
                                      id="MITenure" placeholder="MI Tenure" [isDirty]="isDirty" [isRequired]="'MI Tenure is Required'"
                                      name="MITenure" (change)="fetchPrmAmount(1,'motor',i,'callFun')" [maxLength]="labels?.validationData.MITenure.maxLength">
                                    </app-custom-input>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="fundingRequiredforMI">{{ labels?.fundingRequiredforMI }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div *ngIf="this.showapplicable" class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="FundingRequiredLOV" formControlName="fundingRequiredforMI" [isDirty]="isDirty" [isRequired]="'Is Funding Required for MI is required'"
                                      (change)="calculateTotal(i)">
                                    </app-vf-custom-select>
                                  </div>
                                  <div *ngIf="!this.showapplicable" class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="tempDataFundingRequiredLOV" formControlName="fundingRequiredforMI" (change)="calculateTotal(i)"
                                      [isRequired]="'Is Funding Required for life-cover is required'">
                                    </app-vf-custom-select>
                                  </div>
                                </div>
                              </div>
                                <div formGroupName="pac" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="creditShieldPAC"> {{ InsuranceProvidersLabel[1].insurance_type_name }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3 position-relative">
                                      <!-- calculatepremiumAmount($event,2,i) -->
                                    <app-vf-custom-select [values]="PACInsuranceProvidersLOV" formControlName="creditShieldPAC" [isDirty]="isDirty" [isRequired]="'Credit Shield - PAC is required'"
                                      (change)="getUIValues($event, true, 'PAC',i);fetchPrmAmount(1,'motor',i,'callFun')">
                                    </app-vf-custom-select>
                                    <!-- <button type="button" [disabled]="PACButtonFlag[i]" 
                                  click)="fetchPreimumAmount(2,pACInsuranceProviderName)" 
                                  class="calc-icon"></button> -->
                                  </div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="fundingRequiredforPAC">{{ labels?.fundingRequiredforPAC }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div *ngIf="this.showapplicable" class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="FundingRequiredLOV" formControlName="fundingRequiredforPAC" [isDirty]="isDirty" (change)="calculateTotal(i)"
                                      [isRequired]="'Is Funding Required for PAC is required'">
                                    </app-vf-custom-select>
                                  </div>
                                  <div *ngIf="!this.showapplicable" class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="tempDataFundingRequiredLOV" formControlName="fundingRequiredforPAC" (change)="calculateTotal(i)"
                                      [isRequired]="'Is Funding Required for life-cover is required'">
                                    </app-vf-custom-select>
                                  </div>
                                </div>
                              </div>
                              <div formGroupName="vas" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="VAS">{{ InsuranceProvidersLabel[3].insurance_type_name}}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3 position-relative"> 
                                  <!-- calculatepremiumAmount($event,4,i) -->
                                    <app-vf-custom-select [values]="VASInsuranceProvidersLOV" formControlName="VAS" (change)="getUIValues($event, true,'VAS',i);fetchPrmAmount(1,'motor',i,'callFun')" [isDirty]="isDirty" [isRequired]="'VAS is required'">
                                    </app-vf-custom-select>
                                    <!-- <button type="button" [disabled]="VASButtonFlag[i]" 
                                  (click)="fetchPreimumAmount(4,vASInsuranceProvidersName)" 
                                  class="calc-icon"></button> -->
                                  </div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="fundingRequiredforVAS">{{ labels?.fundingRequiredforVAS }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div *ngIf="this.showapplicable" class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="FundingRequiredLOV" [isDirty]="isDirty" formControlName="fundingRequiredforVAS" (change)="calculateTotal(i)"
                                      [isRequired]="'Is Funding Required for VAS is required'">
                                    </app-vf-custom-select>
                                  </div>
                                  <div *ngIf="!this.showapplicable" class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="tempDataFundingRequiredLOV" formControlName="fundingRequiredforVAS" (change)="calculateTotal(i)"
                                      [isRequired]="'Is Funding Required for life-cover is required'">
                                    </app-vf-custom-select>
                                  </div>

                                </div>
                                <!-- <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="VASPremiumAmount">{{ labels?.VASPremiumAmount }}
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                    <app-custom-input formControlName="VASPremiumAmount" type="number" class="form-control mandatory select2 custom-negotiation-field"
                                      [isDirty]="isDirty" id="VASPremiumAmount" [maxLength]="labels?.validationData.VASPremiumAmount.maxLength"
                                      placeholder="VAS Premium Amount (in INR)" name="VASPremiumAmount" [isRequired]="'VAS Premium Amount is Required'"
                                      (change)="validateAmount('VASPremiumAmount',i);calculateTotal(i)">
                                    </app-custom-input>
                                  </div>
                                </div> -->
                              </div>
                              <div class="form-group" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                              <div formGroupName="motor">
                                    <label class="control-label col-sm-5 col-md-4 col-lg-3" for="MIPremiumAmount">{{ labels?.MIPremiumAmount }}
                                      <sub class="star_red_col">*</sub>
                                    </label>
                                    <div class="col-sm-6 col-md-4 col-lg-3">
                                        <app-custom-input formControlName="MIPremiumAmount" type="number" id="MIPremiumAmount" placeholder="MI Premium Amount (in INR)"
                                          name="MIPremiumAmount" [isDirty]="isDirty" [maxLength]="labels?.validationData.MIPremiumAmount.maxLength"
                                          [isRequired]="'MI Premium Amount is Required'" class="form-control mandatory select2 custom-negotiation-field"
                                          (change)="validateAmount('MIPremiumAmount',i);calculateTotal(i);validateTenure('motor',i)">
                                          <!-- validateTenure('motor',i); -->
                                        </app-custom-input>
                                      </div>
                              </div>
                              <div formGroupName="pac">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="PACPremiumAmount">{{ labels?.PACPremiumAmount }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                    <app-custom-input formControlName="PACPremiumAmount" type="number" id="PACPremiumAmount" placeholder="PAC Premium Amount (in INR)"
                                      name="PACPremiumAmount" [isDirty]="isDirty" [maxLength]="labels?.validationData.PACPremiumAmount.maxLength"
                                      [isRequired]="'PAC Premium Amount is Required'" class="form-control mandatory select2 custom-negotiation-field"
                                      (change)="validateAmount('PACPremiumAmount',i);calculateTotal(i)">
                                    </app-custom-input>
                                </div>

                            </div>
                              </div>
                              <div class="form-group" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                                  <div formGroupName="vas">
                                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="VASPremiumAmount">{{ labels?.VASPremiumAmount }}
                                        <sub class="star_red_col">*</sub>
                                      </label>
                                      <div class="col-sm-6 col-md-4 col-lg-3">
                                        <!-- <app-custom-input formControlName="VASPremiumAmount" type="number" class="form-control mandatory select2 custom-negotiation-field"
                                    id="VASPremiumAmount" [maxLength]="labels?.validationData.VASPremiumAmount.maxLength" placeholder="VAS Premium Amount (in INR)"
                                    name="VASPremiumAmount" [isDirty]="isDirty" [isRequired]="'VAS Premium Amount is Required'" (change)="calculateTotal(i)">
                                    </app-custom-input> -->
                                        <app-custom-input formControlName="VASPremiumAmount" type="number" class="form-control mandatory select2 custom-negotiation-field"
                                          [isDirty]="isDirty" id="VASPremiumAmount" [maxLength]="labels?.validationData.VASPremiumAmount.maxLength"
                                          placeholder="VAS Premium Amount (in INR)" name="VASPremiumAmount" [isRequired]="'VAS Premium Amount is Required'"
                                          (change)="validateAmount('VASPremiumAmount',i);calculateTotal(i)">
                                        </app-custom-input>
                                      </div>
                                      </div>
                              </div>
                              <div formGroupName="life" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="creditShieldLifeCover">{{ InsuranceProvidersLabel[2].insurance_type_name }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3 position-relative">
                                      <!-- calculatepremiumAmount($event,3,i) -->
                                    <app-vf-custom-select [values]="creditShieldInsuranceProvidersLOV" formControlName="creditShieldLifeCover" [className]="'form-control mandatory'"
                                      [isDirty]="isDirty" [isRequired]="'Credit Shield Life Cover is Required'" (change)="getUIValues($event, true, 'creditShield',i);fetchPrmAmount(3,'creditShieldInsurance',i,'callFun')">
                                    </app-vf-custom-select>
                                    <button type="button" [disabled]="lifeButtonFlag[i]" (click)="fetchPrmAmount(3,'creditShieldInsurance',i,'callFun')" class="calc-icon"></button>
                                  </div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="fundingforLifeCover">{{ labels?.fundingforLifeCover }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="InsuranceSlabLOV" [isDirty]="isDirty" formControlName="fundingforLifeCover" [className]="'form-control mandatory'"
                                      [isRequired]="'Is Funding Required for Lifer Cover is required'" (change)="getFundingReq($event,i);fetchPrmAmount(3,'creditShieldInsurance',i,'callFun')">
                                    </app-vf-custom-select>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="fundingRequiredforPAC">{{ labels?.fundingRequiredforlifeCover }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div *ngIf="this.showapplicableCredit" class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="FundingRequiredLOV" formControlName="fundingRequiredforlifeCover" (change)="calculateTotal(i)"
                                      [isRequired]="'Is Funding Required for life-cover is required'">
                                    </app-vf-custom-select>
                                  </div>
                                  <div *ngIf="!this.showapplicableCredit" class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="tempDataFundingRequiredLOV" formControlName="fundingRequiredforlifeCover" (change)="calculateTotal(i)"
                                      [isRequired]="'Is Funding Required for life-cover is required'">
                                    </app-vf-custom-select>
                                  </div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="lifeCoverPremiumAmount">{{ labels?.lifeCoverPremiumAmount }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                    <app-custom-input formControlName="lifeCoverPremiumAmount" type="number" class="form-control mandatory select2 custom-negotiation-field"
                                      id="lifeCoverPremiumAmount" [isDirty]="isDirty" [maxLength]="labels?.validationData.lifeCoverPremiumAmount.maxLength"
                                      placeholder="Life Cover Premium Amount (in INR)" name="lifeCoverPremiumAmount" [isRequired]="'Life Cover Premium Amount is required'"
                                      (change)="validateTenure('creditShieldInsurance',i);validateAmount('lifeCoverPremiumAmount',i);calculateTotal(i)">
                                    </app-custom-input>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div formGroupName="fastTag">
                                <div class="form-group">
                                    <label class="control-label col-sm-5 col-md-4 col-lg-3" for="EquitasFASTagRequired">{{ labels?.EquitasFASTagRequired }}
                                      <sub class="star_red_col">*</sub>
                                    </label>
                                    <div class="col-sm-6 col-md-4 col-lg-3">
                                      <app-vf-custom-select [values]="FASTagReqLOV" [isDirty]="isDirty" (change)="getUIValues($event, true, 'fastTag',i);calculateTotal(i)"
                                        formControlName="EquitasFASTagRequired" [isRequired]="'Is fastTag Required is Required'">
                                      </app-vf-custom-select>
                                    </div>
                                    <label class="control-label col-sm-5 col-md-4 col-lg-3" for="FASTagAmount">{{ labels?.FASTagAmount }}
                                      <sub class="star_red_col">*</sub>
                                    </label>
                                    <div class="col-sm-6 col-md-4 col-lg-3">
                                      <!-- <app-custom-input formControlName="FASTagAmount" type="number" class="form-control mandatory select2 custom-negotiation-field"
                                    id="FASTagAmount" placeholder="FASTag Amount (in INR)" name="FASTagAmount" (change)="calculateTotal(i)"
                                    [maxLength]="labels?.validationData.FASTagAmount.maxLength" [isRequired]="'FAST Tag Amount is Required'"
                                    [isDirty]="isDirty"></app-custom-input> -->
                                      <app-custom-input formControlName="FASTagAmount" type="number" class="form-control mandatory select2 custom-negotiation-field"
                                        id="FASTagAmount" placeholder="FASTag Amount (in INR)" name="FASTagAmount" (change)="validateAmount('fastTag',i);calculateTotal(i)"
                                        [maxLength]="labels?.validationData.FASTagAmount.maxLength" [isRequired]="(this.createNegotiationForm.get('tickets')['controls'][i]['controls'].
                                     fastTag['controls'].EquitasFASTagRequired.value == '2')? null :'FAST Tag Amount is Required'" [isDirty]="isDirty"></app-custom-input>
                                    </div>
                                  </div>
                                  <div class="form-group">
                                      <label class="control-label col-sm-5 col-md-4 col-lg-3" for="fundingRequiredforFASTag">{{ labels?.fundingRequiredforFASTag }}
                                        <sub class="star_red_col">*</sub>
                                      </label>
                                      <div *ngIf="this.showapplicableFastag" class="col-sm-6 col-md-4 col-lg-3">
                                        <app-vf-custom-select [values]="FundingRequiredLOV" formControlName="fundingRequiredforFASTag" (change)="calculateTotal(i)"
                                          [isRequired]="'Is Funding Required for FASTag is required'" [isDirty]="isDirty">
                                        </app-vf-custom-select>
                                      </div>
                                      <div *ngIf="!this.showapplicableFastag" class="col-sm-6 col-md-4 col-lg-3">
                                        <app-vf-custom-select [values]="tempDataFundingRequiredLOV" formControlName="fundingRequiredforFASTag" (change)="calculateTotal(i)"
                                          [isRequired]="'Is Funding Required for life-cover is required'">
                                        </app-vf-custom-select>
                                      </div>
                                    </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="panel-group col-xs-12" id="accordion">
                      <div class="panel panel-default">
                        <a class="panel-heading collapsed" data-toggle="collapse" data-parent="#accordion" href="#loanbookingDetails{{i+1}}">
                          <h4 class="panel-title">
                            <a> Loan Booking Details <i class="fa fa-angle-down"></i> </a>
                          </h4>
                        </a>
                        <div id="loanbookingDetails{{i+1}}" class="panel-collapse collapse">
                          <div class="panel-body">
                            <div class="clearfix" formGroupName="loanBookingDetails">
                              <div class="form-group">
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="LoanAmountincludingCrossSell">{{ labels?.LoanAmountincludingCrossSell }}
                                  <sub class="star_red_col">*</sub>
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  
                                  <app-custom-input formControlName="LoanAmountincludingCrossSell" [isDirty]="isDirty"  [isRequired]="'Loan Amount including Cross Sell (in INR) is Required'" [className]="'form-control mandatory'"
                                      [placeholder]="'Loan Amount including Cross Sell (in INR)'">
                                    </app-custom-input>
                                </div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="LoanAmountincludingCrossSellsubtractSubvent" *ngIf="(AssetDetailsList[i].schemeType=='S') || (AssetDetailsList[i].schemeType=='SI')">
                                    {{labels?.loanAmountincludingCrossSellsubtracSubvention}} 
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3" *ngIf="(AssetDetailsList[i].schemeType =='S') || (AssetDetailsList[i].schemeType=='SI')">
                                    <input formControlName="LoanAmountincludingCrossSellsubtractSubvent" type="text" class="form-control mandatory select2" id="LoanAmountincludingCrossSellsubtractSubvent"
                                      placeholder="Loan Amount including Cross Sell but subtracting Subvention (in INR)" name="LoanAmountincludingCrossSellsubtractSubvent"
                                    />
                                  </div>
                                </div>
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="MoratoriumPeriod">{{ labels?.MoratoriumPeriod }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select [values]="MoratoriumDaysLOV" formControlName="MoratoriumPeriod" [isDirty]="isDirty" (change)="getRepayableMonths(i);getEMIDate(i,MoratoriumPeriod)"
                                      [isRequired]="'Moratorium / Holiday Period is required'">
                                    </app-vf-custom-select>
                                  </div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NoofRepayableMonthsafterMoratorium">{{ labels?.NoofRepayableMonthsafterMoratorium }} 
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="NoofRepayableMonthsafterMoratorium" [isDirty]="isDirty" [isRequired]="'No. of Repayable Months after Moratorium is Required'" name="NoofRepayableMonthsafterMoratorium" [className]="'form-control mandatory'"
                                      [placeholder]="'No. of Repayable Months after Moratorium'">
                                    </app-custom-input>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="EMIStartDateAfterDisbursement">{{ labels?.EMIStartDateAfterDisbursement }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                    <!-- <app-vf-custom-select formControlName="EMIStartDateAfterDisbursement" [values]="EMIStartDateLOV" [isDirty]="isDirty" [isRequired]="'EMI Start Date After Disbursement is Required'">
                                    </app-vf-custom-select> -->
                                    <app-vf-custom-select [values]="EMICycleDaysLOV" [isDirty]="isDirty" [isRequired]="'EMI Start Date After Disbursement is Required'" formControlName="EMIStartDateAfterDisbursement">
                                      </app-vf-custom-select>
                                  </div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="PaymentModeforGapDaysInterest">{{ labels?.PaymentModeforGapDaysInterest }}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                    <app-vf-custom-select formControlName="PaymentModeforGapDaysInterest" (change)="setLMSCode(i)" [isDirty]="isDirty" [isRequired]="'Payment Mode for Gap Days Interest is Required'" [values]="GapDaysIntPayMode">
                                    </app-vf-custom-select>
                                  </div>
                                </div>
                                <!-- <div class="form-group">
                                  <label class="control-label col-sm-5 note-field col-md-6 col-lg-6">
                                    Note: Upfront deduction of Gap Days Interest is not supported for cheque mode of disbursement, so verify your option once.
                                  </label>
                                </div> -->
                                <!-- *ngIf="LeadReferenceDetails[i].ProductCode == 'UTCR' || LeadReferenceDetails[i].ProductCode == 'NTCR' " -->
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="repaymentFrequency">{{labels?.repaymentFrequency}}
                                    <sub class="star_red_col">*</sub>
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-vf-custom-select formControlName="repaymentFrequency" [values]="RepayFrequencyLOV" [isDirty]="isDirty"
                                  (change)="changeRepaymentFrequency($event,i);setLMSCode(i)" [isRequired]="'Repayment Frequency is Required'">
                                  </app-vf-custom-select>
                                </div>
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="EMIStructure">{{labels?.EMIStructure}}
                                  <sub class="star_red_col">*</sub>
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-vf-custom-select formControlName="EMIStructure" [values]="EMIStructureLOV" (change)="emiStrutureChange(i);setLMSCode(i)" [isDirty]="isDirty" [isRequired]="'EMI Structure is Required'">
                                  </app-vf-custom-select>
                                <input *ngIf="!AssetDetailsList[i]" formControlName="emiDefaultValue" class="form-control">
                                </div>
                                
                              </div>
                              <div class="form-group">
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="SelectAppropriateLMSScheduleCode">{{ labels?.SelectAppropriateLMSScheduleCode }} 
                                  <sub class="star_red_col">*</sub>
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-vf-custom-select formControlName="SelectAppropriateLMSScheduleCode" [values]="tempLMSScheduleLOVData" [isDirty]="isDirty" [isRequired]="'LMS Schedule Code is Required'">
                                  </app-vf-custom-select>
                                </div>
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="loanBookingEMI">{{labels?.EMIAfterCrossSell}}</label>
                                <!-- <div class="col-sm-6 col-md-4 col-lg-3">
                                    <input formControlName="loanBookingEMI" type="text" class="form-control mandatory select2" id="loanBookingEMI"
                                    placeholder="EMI After Cross Sell" name="loanBookingEMI"
                                  />
                                </div> -->
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="loanBookingEMI" [isDirty]="isDirty" [className]="'form-control'"
                                  [type]="'number'" [placeholder]="'EMI After Cross Sell'" (change)="allowValuesforNegoEMI($event,i,2)">
                                  </app-custom-input>
                                </div>
                              </div>
                            <div *ngIf="((createNegotiationForm.get('tickets')['controls'][i]['controls'].loanBookingDetails['controls']['EMIStructure']['value']) && (createNegotiationForm.get('tickets')['controls'][i]['controls'].loanBookingDetails['controls']['EMIStructure']['value']!='1EMISTRUCT'))" [formGroup]="ticket">
                              <div formGroupName="variableForm" class="col-sm-6 emi-table">
                                <h4>Variable EPI Schedule</h4>
                                <table border=1 formArrayName="variableFormArray">
                                  <thead>
                                    <th>{{labels?.fromMonth}}</th>
                                    <th>{{labels?.toMonth}}</th>
                                    <th>{{labels?.EMIAmount}}</th>
                                  <th class="emi-table-action" *ngIf="createNegotiationForm.get('tickets')['controls'][i]['controls'].loanBookingDetails['controls']['EMIStructure']['value']!='4EMISTRUCT'">Action</th>
                                  </thead>
                                  <tbody>
                                    <!-- //<tr *ngFor="let itemrow of createNegotiationForm.controls.variableFormArray.controls; let i=index;let l=last" [formGroupName]="i"> -->
                                    <tr *ngFor="let itemrow of ticket.controls.variableForm.controls.variableFormArray.controls; let o=index" [formGroupName]="o">
                                      <td>
                                        <input formControlName="fromMonth" class="form-control">
                                      </td>
                                      <td>
                                      <input formControlName="toMonth" (keypress)="isNumber($event)"(change)="getToMonthVal($event,i,o)" class="form-control">
                                      </td>
                                      <td>
                                      <input formControlName="emiAmount" (keypress)="isNumber($event)" (change)="enterEmiCall($event,i,o)" class="form-control">
                                    </td>
                                      <td *ngIf="createNegotiationForm.get('tickets')['controls'][i]['controls'].loanBookingDetails['controls']['EMIStructure']['value'] !='4EMISTRUCT'">
                                      <button type="button" (click)="addNewRow(i,o)" class="btn btn-primary btn-sm" title="Add New Row"
                                        [disabled]="(!((ticket.controls.variableForm.controls.variableFormArray.controls.length-1)==o)) || ((createNegotiationForm.get('tickets')['controls'][i]['controls'].loanBookingDetails['controls']['NoofRepayableMonthsafterMoratorium']['value']-1)==ticket.controls.variableForm.value.variableFormArray[0].toMonth)">
                                          <i class="fa fa-plus"></i>
                                        </button>
                                      <button *ngIf="ticket.controls.variableForm.controls.variableFormArray.controls.length > 1 && o!=0" [disabled]="!((ticket.controls.variableForm.controls.variableFormArray.controls.length-1)==o)" (click)="deleteRow(i,o)"
                                          class="btn btn-danger btn-sm" title="Delete">
                                          <i class="fa fa-trash"></i>
                                        </button>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              <button type="button" (click)="validateVarFormArray(i)" class="btn btn-primary calc-btn" >Validate</button>
                                <!-- <button type="button" (click)="calculatestage()" class="btn btn-primary calc-btn" >calculate</button> -->
                              </div>
                            <!-- mock table must filled column should add as condition -->
                            <div formGroupName="mockSchForm" class="col-sm-6 mock-table" *ngIf="(this.createNegotiationForm['controls']['tickets']['controls'][i]['controls']['mockSchForm'].get('mockSchFormArray').controls.length>0)">
                              <h4>Mock Schedule</h4>
                            <div class="mock-table-scroll">
                              <table border=1 formArrayName="mockSchFormArray">
                                  <thead>
                                  <th>{{labels?.instalmentNo}}</th>
                                  <th>{{labels?.installmentDate}}</th>
                                  <th>{{labels?.totalIntallmentAmount}}</th>
                                  <th>{{labels?.principle}}</th>
                                  <th>{{labels?.interest}}</th>
                                  <th>{{labels?.principleOutstanding}}</th>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="let itemrow of ticket.controls.mockSchForm.controls.mockSchFormArray.controls; let o=index" [formGroupName]="o">
                                      <td>
                                      <input formControlName="installmentCounter" class="form-control">
                                      </td>
                                      <td>
                                      <input formControlName="installmentDate" class="form-control">
                                      </td>
                                      <td>
                                      <input formControlName="totalInstallmentAmount" class="form-control">
                                      </td>
                                      <td>
                                      <input formControlName="principalAmount" class="form-control">
                                      </td>
                                      <td>
                                      <input formControlName="interestAmount" class="form-control">
                                      </td>
                                      <td>
                                      <input formControlName="principalBalanceAmount" class="form-control">
                                      </td>                                       
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                          </div>

                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="panel-group col-xs-12" id="accordion">
                    <div class="panel panel-default" [formGroup]="ticket">
                      <a class="panel-heading collapsed" data-toggle="collapse" data-parent="#accordion" href="#deductionCharges{{i+1}}">
                        <h4 class="panel-title" >
                          <a> {{ labels?.charges }}<i class="fa fa-angle-down"></i> </a>
                        </h4>
                      </a>
                      <div id="deductionCharges{{i+1}}" class="panel-collapse collapse" [formGroup]="ticket">
                        <div class="panel-body">
                          <div class="clearfix">
                            <div *ngFor="let ticket1 of deductChargesArray.controls; let k = index">
                              <div [formGroup]="ticket1">
                                <div>
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="CreditShieldCharges">{{deductionLabel[k]}}</label>
                                  <div class="col-sm-6 col-md-4 col-lg-3 label-space ">
                                    <app-custom-input formControlName="DeductionChargefixedRate" [isDirty]="isDirty" [className]="'form-control mandatory'" [type]="'number'"
                                      (change)="getNetDisbursementAmount(i)" [maxLength]="labels?.validationData.DeductionChargefixedRate.maxLength"
                                      [placeholder]="'Deduction Charges (in INR)'">
                                    </app-custom-input>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="panel-group col-xs-12" id="accordion">
                    <div class="panel panel-default">
                      <a class="panel-heading collapsed" data-toggle="collapse" data-parent="#accordion" href="#loanamountBreakup{{i+1}}">
                        <h4 class="panel-title">
                          <a> Loan Amount Breakup Summary (Tentative) <i class="fa fa-angle-down"></i></a>
                        </h4>
                      </a>
                      <div id="loanamountBreakup{{i+1}}" class="panel-collapse collapse">
                        <div class="panel-body">
                          <div class="clearfix" formGroupName="loanAmountBreakup">
                              <div class="form-group">
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="finalAssetCost">{{labels?.finalAssetCosts}}
                                </label>
                                <div class="col-sm-6 col-md-4 col-lg-3">
                                  <app-custom-input formControlName="finalAssetCost" [isDirty]="isDirty" [className]="'form-control mandatory'"
                                     placeholder="Final Asset Cost (in INR)">
                                  </app-custom-input>
                                </div>
                                <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NegotiatedLoanAmount">{{ labels?.NegotiatedLoanAmount }}
                                    
                                  </label>
                                  <div class="col-sm-6 col-md-4 col-lg-3">
                                    <app-custom-input formControlName="NegotiatedLoanAmount" [isDirty]="isDirty" [className]="'form-control mandatory'" [type]="'number'"
                                      [placeholder]="'Negotiated Loan Amount'">
                                    </app-custom-input>
                                  </div>
                              </div>
                            <div class="form-group">
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="LoanAmountincludingCrossSell">{{ labels?.LoanAmountincludingCrossSell }}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input formControlName="LoanAmountincludingCrossSell" [isDirty]="isDirty" [className]="'form-control mandatory'"
                                      [placeholder]="'Loan Amount including Cross Sell (in INR)'">
                                    </app-custom-input>
                              </div>
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="LoanAmountincludingCrossSellsubtractSubvent" *ngIf="(AssetDetailsList[i].schemeType =='S') || (AssetDetailsList[i].schemeType=='SI')">{{labels?.loanAmountincludingCrossSellsubtracSubvention}}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <input type="text" formControlName="LoanAmountincludingCrossSellsubtractSubvent" *ngIf="(AssetDetailsList[i].schemeType =='S') || (AssetDetailsList[i].schemeType=='SI')" class="form-control mandatory select2" id="LoanAmountincludingCrossSellsubtractSubvent"
                                  placeholder="Loan Amount including Cross Sell but subtracting Subvention (in INR)" name="LoanAmountincludingCrossSellsubtractSubvent"
                                />
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="finalLTV">{{labels?.finalLTV}}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input formControlName="finalLTV" id="finalLTV" placeholder="Final LTV (in %)"
                                  name="finalLTV" class="form-control select2 custom-negotiation-field">
                                </app-custom-input>
                              </div>
                              <label *ngIf="(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))" class="control-label col-sm-5 col-md-4 col-lg-3" for="FASTagAmount">{{ labels?.FASTagAmount }} </label>
                              <div class="col-sm-6 col-md-4 col-lg-3" *ngIf="(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                                <app-custom-input type="number" formControlName="FASTagAmount" class="form-control mandatory select2 custom-negotiation-field"
                                  id="FASTagAmount" placeholder="FASTag Amount (in INR)" name="FASTagAmount"></app-custom-input>
                              </div>
                              <label *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))" class="control-label col-sm-5 col-md-4 col-lg-3" for="MIPremiumAmount">{{ labels?.MIPremiumAmount }}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                                <app-custom-input type="number" formControlName="MIPremiumAmount" id="MIPremiumAmount" placeholder="MI Premium Amount (in INR)"
                                  name="MIPremiumAmount"  class="form-control mandatory select2 custom-negotiation-field">
                                </app-custom-input>
                              </div>
                            </div>
                            <div class="form-group" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="PACPremiumAmount">{{ labels?.PACPremiumAmount }}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input formControlName="PACPremiumAmount" type="number" id="PACPremiumAmount" placeholder="PAC Premium Amount (in INR)"
                                  name="PACPremiumAmount" class="form-control mandatory select2 custom-negotiation-field">
                                </app-custom-input>
                              </div>
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="VASPremiumAmount">{{ labels?.VASPremiumAmount }}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input type="number" formControlName="VASPremiumAmount" class="form-control mandatory select2 custom-negotiation-field"
                                   id="VASPremiumAmount" placeholder="VAS Premium Amount (in INR)" name="VASPremiumAmount">
                                </app-custom-input>
                              </div>
                            </div>
                            <div class="form-group" *ngIf="!(showInsuranceFields && (AssetDetailsList[i].IsORPFunding ==  '1'))">
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="lifeCoverPremiumAmount">{{ labels?.lifeCoverPremiumAmount }}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input type="number" formControlName="lifeCoverPremiumAmount" class="form-control mandatory select2 custom-negotiation-field"
                                  id="lifeCoverPremiumAmount" placeholder="Life Cover Premium Amount (in INR)" name="lifeCoverPremiumAmount">
                                </app-custom-input>
                              </div>
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="FASTagAmount">{{ labels?.FASTagAmount }} </label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input type="number" formControlName="FASTagAmount" class="form-control mandatory select2 custom-negotiation-field"
                                  id="FASTagAmount" placeholder="FASTag Amount (in INR)" name="FASTagAmount"></app-custom-input>
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="charges">{{labels?.chargesinINR}}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input type="number" formControlName="charges" class="form-control mandatory select2 custom-negotiation-field"
                                  id="charges" placeholder="Charges (in INR)" name="charges">
                                </app-custom-input>
                              </div>
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="gapDaysInterest">{{labels?.gapDaysInterest}}</label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input type="number" formControlName="gapDaysInterest" class="form-control mandatory select2 custom-negotiation-field"
                                  id="gapDaysInterest" placeholder="Gap Days Interest (in INR)" name="gapDaysInterest">
                                </app-custom-input>
                              </div>
                            </div>
                        </div>
                            <div [formGroup]="ticket">
                              <div formGroupName="negotiationformArray">
                                <div class="form-group">
                                  <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NetDisbursementAmount">{{ labels?.NetDisbursementAmount }}</label>
                                  <div class="col-sm-6 col-md-4 col-lg-3 label-space">
                                    <app-custom-input formControlName="NetDisbursementAmount" [isDirty]="isDirty" [className]="'form-control mandatory'" [placeholder]="'Net Disbursement Amount (in INR)'"></app-custom-input>
                                  </div>
                                  <!-- <label class="control-label col-sm-5 note-field col-md-6 col-lg-6">
                          Note: Taxes will be deducted as applicable
                          </label> -->
                                </div>
                              </div>
                            </div>

                          </div>
                        </div>
                      </div>
                    </div>


                  <div class="panel-group col-xs-12" id="accordion">
                    <div class="panel panel-default">
                      <a class="panel-heading collapsed" data-toggle="collapse" data-parent="#accordion" href="#repaymentMode{{i+1}}">
                        <h4 class="panel-title">
                          <a> {{ labels?.repaymentMode}} <i class="fa fa-angle-down"></i> </a>
                        </h4>
                        <!-- <h4 class="title">{{ labels?.repaymentMode}} - {{i +1}}</h4> -->
                      </a>
                      <div id="repaymentMode{{i+1}}" class="panel-collapse collapse" [formGroup]="ticket">
                        <div class="panel-body">
                          <div class="clearfix" formGroupName="repaymentmodeArray">
                            <div class="form-group">
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="repaymentMode">{{labels?.repaymentMode}}
                                <sub class="star_red_col">*</sub>
                              </label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-vf-custom-select [values]="RepaymentLOV" [isDirty]="isDirty" (change)="calculateMinMax('empty',i)" [isRequired]="'Repayment Mode is Required'"
                                  formControlName="repaymentMode">
                                </app-vf-custom-select>
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NoofPDC">{{labels?.noOfPdc}}
                                <sub class="star_red_col">*</sub>
                              </label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input formControlName="NoofPDC" [isDirty]="isDirty" [className]="'form-control mandatory'" [type]="'number'"
                                  [isRequired]="'PDC Value is Required'" [placeholder]="'PDC Value'" (change)="calculateMinMax($event.target.value,i)"
                                  [custom]="PDCvalueCheck" [minLength]="labels?.validationData.NoofPDC.minLength" [maxLength]="labels?.validationData.NoofPDC.maxLength">
                                </app-custom-input>
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="control-label col-sm-5 col-md-4 col-lg-3" for="NoofSPDC">{{labels?.NoofSPDC}}
                                <sub class="star_red_col">*</sub>
                              </label>
                              <div class="col-sm-6 col-md-4 col-lg-3">
                                <app-custom-input formControlName="NoofSPDC" [isDirty]="isDirty" [className]="'form-control mandatory'" [type]="'number'"
                                  [isRequired]="'SPDC Value is Required'" [placeholder]="'SPDC Value'" (change)="calculateMinMax('',i)"
                                  [custom]="SPDCvalueCheck" [minLength]="labels?.validationData.NoofSPDC.minLength" [maxLength]="labels?.validationData.NoofSPDC.maxLength">
                                </app-custom-input>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>


                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

     
      <div class="btn-sec button-section clear-both">
        <div class="col-sm-12 text-right">
          <button type="button" class="btn btn-primary hvr-sweep-to-left" value="back"
            *ngIf="roleType == '1' || roleType == '7'" (click)="onBack()">
            {{ labels?.back }}
          </button>
          <!-- <button (click)="onBack()" class="btn btn-primary mar-right8" type="button" >Back </button>&nbsp; -->
          <button type="button" class="btn btn-primary" value="cancel" (click)="cancel()" *ngIf="!isLoan360">
            {{ labels?.cancel }}
          </button>
          <ng-container *ngIf="!isLoan360">
            <button type="button" class="btn btn-primary" value="submit" (click)="onSubmit()"
              *ngIf="roleType != 4 && roleType != 5">
              {{ labels?.save }}
            </button>
          </ng-container>

          <button (click)="onNext()" class="btn btn-primary js-btn-next hvr-sweep-to-right" type="button"> Next
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
<!-- Footer -->
<footer class="footer pf mob-font">
  <div class="container-fluid">
    <p>© Equitas Small Finance Bank Limited. All Rights Reserved.</p>
  </div>
</footer>
