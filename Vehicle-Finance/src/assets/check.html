<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Hetra</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="./assets/images/favicon.PNG"> 
  <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
  <script src="./assets/js/jquery-1.12.4.min.js"></script>
  <script src="./assets/js/bootstrap.min.js"></script>
  <script src="./assets/js/popper.min.js"></script>
 
  <style>
    body {
  height: 100vh;
  width: 100vw;
}
    
  
  .card {
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
  }
  
  .card:hover {
    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
  }
  
  .container {
    height: 100%;
    width: 100%;
  }
  
  .header {
    padding: 5px;
  }
  
  .image-content {
    height: 100%;
    width: 100%;
    margin: 0 auto;
    overflow: scroll;
    text-align: center;
    padding: 5%;
  }
  
  .center {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }
  
  .cls-btn{
    color:#2b2727;
    opacity:1;
    font-size:25px!important;
  }
  
  @media (min-width:300px) and (max-width:767px) {
    .image-content {
      height: 1000%;
      width: 100%;
      margin: auto;
    }
  
    #mydiv {
      z-index: 9999;
      background-color: #1d1d1d61;
      border: 1px solid #d3d3d3;
      text-align: center;
      height: 85%;
      width: 100%;
      /* padding: 10px; */
      border-radius: 5px;
      margin-top:20px;
  }
  }
  </style>

  
</head>


<body onload="afterLoad()">

  <!-- <div > -->
    <div class="image-content" id="imageContent" >
    </div>
  <!-- </div> -->


</body>
<script>
  const value = localStorage.getItem('_expiredTime');
  //const imageObject = JSON.parse(localStorage.getItem(window.imageTime));
  const imageObject = window.image;
  console.log('imageObject', imageObject);
  const imageType = imageObject.imageType;
  let src = imageObject.imageUrl;
  const fileName = imageObject.name;

  function afterLoad() {
    console.log('after loaded');
    if (!!value) {
        
        if (imageType.includes('jpeg')  || imageType.includes('png')) {
          console.log('1');
          src = 'data:image/jpeg;base64,' + src;
          //  this.sanitizer.bypassSecurityTrustResourceUrl(
          //   'data:image/jpeg;base64,' + value.imageUrl
          // );
        } else if (imageType.includes('pdf')) {
          console.log('2');
          const blob = base64ToBlob( src, 'application/pdf' );
          const url = URL.createObjectURL( blob );
          src = url;
          //this.sanitizer.bypassSecurityTrustResourceUrl(url);
        } 
        // else if (this.imageType === 'xls') {
        //   this.src = this.sanitizer.bypassSecurityTrustResourceUrl(
        //     'data:application/vnd.ms-excel;base64' + value.imageUrl
        //   );
        // } 
        else if (imageType.includes('doc')) {
          console.log(3)
          const blob = base64ToBlob( src,  'application/vnd.openxmlformats-officedocument.wordprocessingml.document');
          const url = URL.createObjectURL( blob );
          src = url
          //t
          his.sanitizer.bypassSecurityTrustResourceUrl(url);
        }
        console.log(4)
      }
    if(imageType.includes('pdf')) {
      const iframe = document.createElement('iframe');
      iframe.frameBorder=0;
      iframe.width="600";
      iframe.height="600";
      iframe.id = 'content_iframe'
     // const doc = iframe.contentWindow? iframe.contentWindow.document : iframe.contentDocument;
      // console.log('doc', doc)
     // doc.title = fileName;
      //iframe.contentDocument.title = fileName;
      // iframe.name = fileName;
      iframe.src = src;
      document.getElementById("imageContent").appendChild(iframe);

      setTimeout(() => {
          document.getElementById('title').innerHTML = fileName;
      }, 300);
    } else if (imageType.includes('png') || imageType.includes('jpeg')) {
      const img = document.createElement("img");
      img.src = src;
      img.height = "600";
      img.width = "600";
      document.getElementById("imageContent").appendChild(img);
    }
  }

  function base64ToBlob(base64, type = 'application/octet-stream') {
    const binStr = atob( base64 );
    const len = binStr.length;
    const arr = new Uint8Array(len);
    for (let i = 0; i < len; i++) {
      arr[ i ] = binStr.charCodeAt( i );
    }
    return new Blob( [ arr ], { type} );
  }

</script>
</html>
